geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y,label="",col=YEAR))
YEAR<-c("Point","NonPoint","Road","NonRoad")
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y,label="",col=YEAR))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
scale_fill_discrete(breaks=c("Point","NonPoint","Road","NonRoad"))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y,label="",col=YEAR))+
scale_fill_discrete(breaks=c("Point","NonPoint","Road","NonRoad"))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line( mapping=aes(x=X, y=Y,label="",col=YEAR))+
scale_fill_discrete(breaks=c("Point","NonPoint","Road","NonRoad"))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line( mapping=aes(x=X, y=Y,col=YEAR))
ggplot(PointMeans, aes(PointMeans[,1]),col=YEAR)+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")
Type<-c("Point","NonPoint","Road","NonRoad")
#Saving to png file
png(filename='./figure/plot3.png', width = 480, height = 480)
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line( mapping=aes(x=X, y=Y,col=Type))
dev.off()
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line( mapping=aes(x=X, y=Y,col=Type))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line( mapping=aes(col=Type))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line(y=rep(1,4); mapping=aes(col=Type))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line(mapping=aes(y=rep(1,4),col=Type))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line(mapping=aes(y=rep(12,4),col=Type))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_line(mapping=aes(y=rep(12,4),col=Type))+
scale_colour_manual("",
breaks = c("TempMax", "TempMedia", "TempMin"),
values = c("red", "green", "blue")) +
xlab(" ") +
scale_y_continuous("Temperatura (C)", limits = c(-10,40)) +
opts(title="TITULO")
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
scale_colour_manual("",
breaks = c("TempMax", "TempMedia", "TempMin"),
values = c("red", "green", "blue")) +
xlab(" ") +
scale_y_continuous("Temperatura (C)", limits = c(-10,40)) +
opts(title="TITULO")
labels<-c("Point","NonPoint","Road","NonRoad")
X<-rep(2004,4)
Y=c(14,16,12.4,13)
col<-c("green","red","black","blue")
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=0,col=col))
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=0,col=col))+ theme(legend.position="none")
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=6))+
theme(legend.position="none")
labels<-c("Point","NonPoint","Road","NonRoad")
X<-rep(2004,4)
Y=c(14,15.5,12,13)
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("Emissions")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=6))+
theme(legend.position="none")
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("log(Total Emissions)")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=6))+
theme(legend.position="none")
rm(list=ls())
#Reading the dataset
NEI <- readRDS("./exdata-data-NEI_data/summarySCC_PM25.rds");
SCC <- readRDS("./exdata-data-NEI_data/Source_Classification_Code.rds");
library(ggplot2)
#Comparison of different particle types
NEI_POINT<-NEI[NEI[,5]=="POINT",]
PointMeans<-aggregate(NEI_POINT$Emissions, list(NEI_POINT$year), sum)
NEI_NONPOINT<-NEI[NEI[,5]=="NONPOINT",]
NONPointMeans<-aggregate(NEI_NONPOINT$Emissions, list(NEI_NONPOINT$year), sum)
NEI_ONROAD<-NEI[NEI[,5]=="ON-ROAD",]
ONROADMeans<-aggregate(NEI_ONROAD$Emissions, list(NEI_ONROAD$year), sum)
NEI_NONROAD<-NEI[NEI[,5]=="NON-ROAD",]
NONROADMeans<-aggregate(NEI_NONROAD$Emissions, list(NEI_NONROAD$year), sum)
labels<-c("Point","NonPoint","Road","NonRoad")
X<-rep(2004,4)
Y=c(14,15.5,12,13)
#Saving to png file
png(filename='./figure/plot3.png', width = 480, height = 480)
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("log(Total Emissions)")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=6))+
theme(legend.position="none")
dev.off()
#Reading the dataset
NEI <- readRDS("./exdata-data-NEI_data/summarySCC_PM25.rds");
SCC <- readRDS("./exdata-data-NEI_data/Source_Classification_Code.rds");
library(ggplot2)
#Comparison of different particle types
NEI_POINT<-NEI[NEI[,5]=="POINT",]
PointMeans<-aggregate(NEI_POINT$Emissions, list(NEI_POINT$year), sum)
NEI_NONPOINT<-NEI[NEI[,5]=="NONPOINT",]
NONPointMeans<-aggregate(NEI_NONPOINT$Emissions, list(NEI_NONPOINT$year), sum)
NEI_ONROAD<-NEI[NEI[,5]=="ON-ROAD",]
ONROADMeans<-aggregate(NEI_ONROAD$Emissions, list(NEI_ONROAD$year), sum)
NEI_NONROAD<-NEI[NEI[,5]=="NON-ROAD",]
NONROADMeans<-aggregate(NEI_NONROAD$Emissions, list(NEI_NONROAD$year), sum)
labels<-c("Point","NonPoint","Road","NonRoad")
X<-rep(2004,4)
Y=c(14,15.5,12,13)
#Saving to png file
png(filename='./figure/plot3.png', width = 480, height = 480)
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("log(Total Emissions)")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=6))+
theme(legend.position="none")
dev.off()
#Reading the dataset
NEI <- readRDS("./exdata-data-NEI_data/summarySCC_PM25.rds");
SCC <- readRDS("./exdata-data-NEI_data/Source_Classification_Code.rds");
library(ggplot2)
#Comparison of different particle types
NEI_POINT<-NEI[NEI[,5]=="POINT",]
PointMeans<-aggregate(NEI_POINT$Emissions, list(NEI_POINT$year), sum)
NEI_NONPOINT<-NEI[NEI[,5]=="NONPOINT",]
NONPointMeans<-aggregate(NEI_NONPOINT$Emissions, list(NEI_NONPOINT$year), sum)
NEI_ONROAD<-NEI[NEI[,5]=="ON-ROAD",]
ONROADMeans<-aggregate(NEI_ONROAD$Emissions, list(NEI_ONROAD$year), sum)
NEI_NONROAD<-NEI[NEI[,5]=="NON-ROAD",]
NONROADMeans<-aggregate(NEI_NONROAD$Emissions, list(NEI_NONROAD$year), sum)
labels<-c("Point","NonPoint","Road","NonRoad")
X<-rep(2004,4)
Y=c(14,15.5,12,13)
#Saving to png file
png(filename='./figure/plot3.png', width = 480, height = 480)
ggplot(PointMeans, aes(PointMeans[,1]))+
geom_line(aes(y=log(PointMeans[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(PointMeans[,2])), colour="red",size=3)+
geom_line(aes(y=log(NONPointMeans[,2])), colour="green",size=0.3)+  # first layer
geom_point(aes(y=log(NONPointMeans[,2])), colour="green",size=3)+
geom_line(aes(y=log(ONROADMeans[,2])), colour="blue",size=0.3)+  # first layer
geom_point(aes(y=log(ONROADMeans[,2])), colour="blue",size=3)+
geom_line(aes(y=log(NONROADMeans[,2])), colour="black",size=0.3)+
geom_point(aes(y=log(NONROADMeans[,2])), colour="black",size=3)+
ylab("log(Total Emissions)")+xlab("years")+ggtitle("Comparison of different particle types")+
geom_text( mapping=aes(x=X, y=Y, label=labels, size=6))+
theme(legend.position="none")
dev.off()
CoalRelatedIndexes<-as.character(SCC[grep("[cC][oO][aA][lL]",SCC[,3]),1])
NEI_COAL<-NEI[NEI[,2]%in%CoalRelatedIndexes,]
tempCoal<-split(NEI_COAL[,"Emissions"], NEI_COAL[,"year"])
plotCoal<-boxplot(tempCoal,outline=FALSE)
lines(plotCoal$stats[3,],lwd=0.9,col="darkgreen")
#text(as.numeric(names(temp)), as.numeric(lapply(temp,mean)), labels = formatC(as.numeric(lapply(temp,mean)), format = "f", digits = 1),pos = 2, cex = 0.9, col = "red")
text(plotCoal$stats[3,],substring(as.character(plotCoal$stats[3,]), 0,5),cex=0.55,pos=3,col="darkred")
CoalRelatedIndexes<-as.character(SCC[grep("[cC][oO][aA][lL]",SCC[,3]),1])
NEI_COAL<-NEI[NEI[,2]%in%CoalRelatedIndexes,]
#Summing emission for each year
temp<-aggregate(NEI_COAL[,"Emissions"], by=list(Category=NEI_COAL[,"year"]), FUN=sum)
#Saving to png file
png(filename='./figure/plot1.png', width = 480, height = 480)
barplot(temp[,2]/1000000,temp[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions of PM2.5 in US from 1999-2008")
dev.off()
temp<-aggregate(NEI[,"Emissions"], by=list(Category=NEI[,"year"]), FUN=sum)
#Saving to png file
png(filename='./figure/plot1.png', width = 480, height = 480)
barplot(temp[,2]/1000000,temp[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions of PM2.5 in US from 1999-2008")
dev.off()
CoalRelatedIndexes<-as.character(SCC[grep("[cC][oO][aA][lL]",SCC[,3]),1])
NEI_COAL<-NEI[NEI[,2]%in%CoalRelatedIndexes,]
#Summing emission for each year
temp<-aggregate(NEI_COAL[,"Emissions"], by=list(Category=NEI_COAL[,"year"]), FUN=sum)
#Saving to png file
png(filename='./figure/plot4.png', width = 480, height = 480)
barplot(temp[,2]/1000000,temp[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions from coal comb. sources")
dev.off()
#Summing emission for each year
temp<-aggregate(NEI_COAL[,"Emissions"], by=list(Category=NEI_COAL[,"year"]), FUN=sum)
#Saving to png file
png(filename='./figure/plot4.png', width = 480, height = 480)
barplot(temp[,2]/1000,temp[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in kiloTons",main = "Emissions from coal comb. sources")
dev.off()
MotorBaltimoreIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorBaltimore<-NEI[NEI[,2]%in%MotorBaltimoreIndexes,]
NEI_MotorBaltimore <- NEI_MotorBaltimore[NEI_MotorBaltimore[,1]=="24510",];
#Summing emission for each year
temp<-aggregate(NEI_MotorBaltimore[,"Emissions"], by=list(Category=NEI_MotorBaltimore[,"year"]), FUN=sum)
#Saving to png file
png(filename='./figure/plot5.png', width = 480, height = 480)
barplot(temp[,2]/1000,temp[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in kilo-Tons",main = " Emissions from motor veh. src in Baltimore")
dev.off()
#Summing emission for each year
temp<-aggregate(NEI_MotorBaltimore[,"Emissions"], by=list(Category=NEI_MotorBaltimore[,"year"]), FUN=sum)
#Saving to png file
png(filename='./figure/plot5.png', width = 480, height = 480)
barplot(temp[,2],temp[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = " Emissions from motor veh. src in Baltimore")
dev.off()
par(mfcol = c(2,1));
par(mar=c(0,0,0,0));
MotorBaltimoreIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorBaltimore<-NEI[NEI[,2]%in%MotorBaltimoreIndexes,]
NEI_MotorBaltimore <- NEI_MotorBaltimore[NEI_MotorBaltimore[,1]=="24510",];
tempMotorBaltimore<-split(NEI_MotorBaltimore[,"Emissions"], NEI_MotorBaltimore[,"year"])
plotMotorBaltimore<-boxplot(tempMotorBaltimore,outline=FALSE)
lines(plotMotorBaltimore$stats[3,],lwd=0.9,col="darkgreen")
#text(as.numeric(names(temp)), as.numeric(lapply(temp,mean)), labels = formatC(as.numeric(lapply(temp,mean)), format = "f", digits = 1),pos = 2, cex = 0.9, col = "red")
text(plotMotorBaltimore$stats[3,],substring(as.character(plotMotorBaltimore$stats[3,]), 0,5),cex=0.55,pos=3,col="darkred")
MotorLosAnglesIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorLosAngles<-NEI[NEI[,2]%in%MotorLosAnglesIndexes,]
NEI_MotorLosAngles <- NEI_MotorLosAngles[NEI_MotorLosAngles[,1]=="06037",];
tempMotorLosAngles<-split(NEI_MotorLosAngles[,"Emissions"], NEI_MotorLosAngles[,"year"])
plotMotorLosAngles<-boxplot(tempMotorLosAngles,outline=FALSE)
lines(plotMotorLosAngles$stats[3,],lwd=0.9,col="darkgreen")
#text(as.numeric(names(temp)), as.numeric(lapply(temp,mean)), labels = formatC(as.numeric(lapply(temp,mean)), format = "f", digits = 1),pos = 2, cex = 0.9, col = "red")
text(plotMotorLosAngles$stats[3,],substring(as.character(plotMotorLosAngles$stats[3,]), 0,5),cex=0.55,pos=3,col="darkred")
par(mfcol = c(1,2));
par(mar=c(0,0,0,0));
MotorBaltimoreIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorBaltimore<-NEI[NEI[,2]%in%MotorBaltimoreIndexes,]
NEI_MotorBaltimore <- NEI_MotorBaltimore[NEI_MotorBaltimore[,1]=="24510",];
tempMotorBaltimore<-split(NEI_MotorBaltimore[,"Emissions"], NEI_MotorBaltimore[,"year"])
plotMotorBaltimore<-boxplot(tempMotorBaltimore,outline=FALSE)
lines(plotMotorBaltimore$stats[3,],lwd=0.9,col="darkgreen")
#text(as.numeric(names(temp)), as.numeric(lapply(temp,mean)), labels = formatC(as.numeric(lapply(temp,mean)), format = "f", digits = 1),pos = 2, cex = 0.9, col = "red")
text(plotMotorBaltimore$stats[3,],substring(as.character(plotMotorBaltimore$stats[3,]), 0,5),cex=0.55,pos=3,col="darkred")
MotorLosAnglesIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorLosAngles<-NEI[NEI[,2]%in%MotorLosAnglesIndexes,]
NEI_MotorLosAngles <- NEI_MotorLosAngles[NEI_MotorLosAngles[,1]=="06037",];
tempMotorLosAngles<-split(NEI_MotorLosAngles[,"Emissions"], NEI_MotorLosAngles[,"year"])
plotMotorLosAngles<-boxplot(tempMotorLosAngles,outline=FALSE)
lines(plotMotorLosAngles$stats[3,],lwd=0.9,col="darkgreen")
#text(as.numeric(names(temp)), as.numeric(lapply(temp,mean)), labels = formatC(as.numeric(lapply(temp,mean)), format = "f", digits = 1),pos = 2, cex = 0.9, col = "red")
text(plotMotorLosAngles$stats[3,],substring(as.character(plotMotorLosAngles$stats[3,]), 0,5),cex=0.55,pos=3,col="darkred")
MotorBaltimoreIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorBaltimore<-NEI[NEI[,2]%in%MotorBaltimoreIndexes,]
NEI_MotorBaltimore <- NEI_MotorBaltimore[NEI_MotorBaltimore[,1]=="24510",];
#Summing emission for each year
temp1<-aggregate(NEI_MotorBaltimore[,"Emissions"], by=list(Category=NEI_MotorBaltimore[,"year"]), FUN=sum)
temp1$label<-"Baltimore"
MotorLosAnglesIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorLosAngles<-NEI[NEI[,2]%in%MotorLosAnglesIndexes,]
NEI_MotorLosAngles <- NEI_MotorLosAngles[NEI_MotorLosAngles[,1]=="06037",];
temp2<-aggregate(NEI_MotorLosAngles[,"Emissions"], by=list(Category=NEI_MotorLosAngles[,"year"]), FUN=sum)
temp2$label<-"LosAngles"
temp<-rbind(temp1,temp2)
qplot(temp[,2],temp[,1],geom="density",color<-temp[,3])
qplot(temp[,2],temp[,1],geom="density")
temp[,1]
temp[,2]
temp[,3]
class(temp[,2])
class(temp[,1])
class(temp[,3])
qplot(temp[,2],geom="density",color<-temp[,3])
ggplot(PointMeans, aes(temp1[,1]))+
geom_line(aes(y=log(temp1[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(temp1[,2])), colour="red",size=3)+
geom_line(aes(y=log(temp2[,2])), colour="red",size=0.3,) +  # first layer
geom_point(aes(y=log(temp2[,2])), colour="red",size=3)
MotorLosAnglesIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
par(mfcol = c(1,2));
barplot(temp1[,2]/1000000,temp1[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions of PM2.5 in US from 1999-2008")
barplot(temp2[,2]/1000000,temp2[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions of PM2.5 in US from 1999-2008")
rm(list=ls())
#Reading the dataset
NEI <- readRDS("./exdata-data-NEI_data/summarySCC_PM25.rds");
SCC <- readRDS("./exdata-data-NEI_data/Source_Classification_Code.rds");
MotorBaltimoreIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorBaltimore<-NEI[NEI[,2]%in%MotorBaltimoreIndexes,]
NEI_MotorBaltimore <- NEI_MotorBaltimore[NEI_MotorBaltimore[,1]=="24510",];
#Summing emission for each year
temp1<-aggregate(NEI_MotorBaltimore[,"Emissions"], by=list(Category=NEI_MotorBaltimore[,"year"]), FUN=sum)
temp1$label<-"Baltimore"
MotorLosAnglesIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorLosAngles<-NEI[NEI[,2]%in%MotorLosAnglesIndexes,]
NEI_MotorLosAngles <- NEI_MotorLosAngles[NEI_MotorLosAngles[,1]=="06037",];
temp2<-aggregate(NEI_MotorLosAngles[,"Emissions"], by=list(Category=NEI_MotorLosAngles[,"year"]), FUN=sum)
temp2$label<-"LosAngles"
temp<-rbind(temp1,temp2)
qplot(temp[,2],temp[,1],geom="density")
#Saving to png file
png(filename='./figure/plot6.png', width = 480, height = 480)
par(mfcol = c(1,2));
barplot(temp1[,2]/1000000,temp1[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions of PM2.5 in US from 1999-2008")
barplot(temp2[,2]/1000000,temp2[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in MegaTons",main = "Emissions of PM2.5 in US from 1999-2008")
dev.off()
ggplot(data=temp, aes(x=temp[,1], y=temp[,2])) + geom_bar(aes(fill=temp[,1])) + guides(fill=F) +
ggtitle('Total Emissions of Motor Vehicle Sources\nLos Angeles County, California vs. Baltimore City, Maryland') +
ylab(expression('PM'[2.5])) + xlab('Year') + theme(legend.position='none') + facet_grid(. ~ temp[,3])
ggplot(data=temp, aes(x=temp[,1], y=temp[,2])) + geom_bar(aes(fill=temp[,1])) + guides(fill=F) +
ggtitle('Total Emissions of Motor Vehicle Sources\nLos Angeles County, California vs. Baltimore City, Maryland') +
ylab(expression('PM'[2.5])) + xlab('Year') + theme(legend.position='none')
par(mfcol = c(1,2));
barplot(temp1[,2],temp1[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = "Baltimore City")
barplot(temp2[,2],temp2[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = "LosAngles")
#Saving to png file
png(filename='./figure/plot6.png', width = 480, height = 480)
par(mfcol = c(1,2));
barplot(temp1[,2],temp1[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = "Baltimore City")
barplot(temp2[,2],temp2[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = "LosAngles")
dev.off()
rm(list=ls())
#Reading the dataset
NEI <- readRDS("./exdata-data-NEI_data/summarySCC_PM25.rds");
SCC <- readRDS("./exdata-data-NEI_data/Source_Classification_Code.rds");
MotorBaltimoreIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorBaltimore<-NEI[NEI[,2]%in%MotorBaltimoreIndexes,]
NEI_MotorBaltimore <- NEI_MotorBaltimore[NEI_MotorBaltimore[,1]=="24510",];
#Summing emission for each year
temp1<-aggregate(NEI_MotorBaltimore[,"Emissions"], by=list(Category=NEI_MotorBaltimore[,"year"]), FUN=sum)
temp1$label<-"Baltimore"
MotorLosAnglesIndexes<-as.character(SCC[grep("[mM][oO][tT][oO][rR] | [vV][eE][hH][iI][cC][lL][eE]",SCC[,3]),1])
NEI_MotorLosAngles<-NEI[NEI[,2]%in%MotorLosAnglesIndexes,]
NEI_MotorLosAngles <- NEI_MotorLosAngles[NEI_MotorLosAngles[,1]=="06037",];
temp2<-aggregate(NEI_MotorLosAngles[,"Emissions"], by=list(Category=NEI_MotorLosAngles[,"year"]), FUN=sum)
temp2$label<-"LosAngles"
#Saving to png file
png(filename='./figure/plot6.png', width = 480, height = 480)
par(mfcol = c(1,2));
barplot(temp1[,2],temp1[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = "Baltimore City")
barplot(temp2[,2],temp2[,1],names.arg=c("1999", "2002", "2005","2008"),xlab="Years",ylab="PM2.5 emission in Tons",main = "LosAngles")
dev.off()
